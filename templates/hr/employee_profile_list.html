{% extends "base/base.html" %}
{% block content %}

    <h1 class="text-center mb-4">Employee Profiles</h1>
    <!-- Search & Filter Form -->
  <form method="GET" class="form-inline mb-3">
    <!-- Search input -->
    <input
      type="text"
      name="search"
      class="form-control mr-2"
      placeholder="Search by name, email, title..."
      value="{{ search_query|default_if_none:'' }}"
    />

    <!-- Department dropdown (for example, manually or dynamically populated) -->
    <select name="department" class="form-control mr-2">
      <option value="">All Departments</option>
      {% comment %}
        If your EmployeeProfile.department is a CharField, you could loop over all distinct
        department names. If it's a ForeignKey, loop over Department.objects.all().
      {% endcomment %}
      {% for dept in departments %}
      <option
        value="{{ dept.name }}"
        {% if dept.name == department_filter %}selected{% endif %}
      >
        {{ dept.name }}
      </option>
      {% endfor %}
    </select>
    
    <button type="submit" class="btn btn-primary">Filter</button>
  </form>
    <a href="{% url 'create_employee_profile' %}" class="btn btn-primary mb-3">Add Employee Profile</a>
    <div class="table-responsive">
        <table class="table table-bordered table-hover">
            <thead class="thead-light">
                <tr>
                    <th>Name</th>
                    <th>Department</th>
                    <th>Job Title</th>
                    <th>Date of Hire</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for profile in profiles %}
                <tr onclick="window.location='{% url 'update_employee_profile' profile.id %}'">
                    <td>{{ profile.user.get_full_name }}</td>
                    <td>{{ profile.department }}</td>
                    <td>{{ profile.job_title }}</td>
                    <td>{{ profile.date_of_hire }}</td>
                    <td>
                        <a href="{% url 'update_employee_profile' profile.id %}" class="btn btn-sm btn-warning">Edit</a>
                        <a href="{% url 'update_employee_profile' profile.id %}" class="btn btn-sm btn-info">Details</a>

                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center text-muted">No employee profiles found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

{% endblock %}
